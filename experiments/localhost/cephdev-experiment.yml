# Author: Michael Sevilla
# Create a Ceph development node (with the source code) and start it on the localhost

- name: compile ceph src
  hosts: Builder
  vars:
    - BUILD_THREADS: 32
    - CEPH_PKGS: --with-lttng
    - GIT_URL: https://github.com/michaelsevilla/ceph.git
    - SHA1_OR_REF: remotes/origin/wip-reqlatency
  roles: [ceph-build]

- name: start ceph
  include: start/cephdev.yml

- hosts: Builder
  tasks:
    - name: check to see if ceph started
      command: docker exec ceph-client ceph -s
      register: result
      changed_when: False
    - debug: var=result.stdout_lines
