# Author: Michael Sevilla
# Build zlog and put the binaries in /tmp/docker/{ceph, ceph-zlog, zlog}

- name: pull dependencies for building zlog
  ignore_errors: True
  no_log: True
  docker: 
    image: ci/zlog
    state: present

# This is ugly but the Ansible Docker module doesn't support "entrypoint"
- name: build the zlog binaries
  command: docker run -d --name zlog-build --net=host -e CEPH_NETWORK=127.0.0.1/24 MON_IP=127.0.0.1 -v "etc/ceph/:/etc/ceph" --entrypoint="/blah"
  #docker:
  #  image: ci/zlog
  #  name: zlog-build
  #  state: started
  #  net: host
  #  env:
  #     CEPH_NETWORK: 127.0.0.1/24
  #     MON_IP: 127.0.0.1
  #  volumes:
  #    - "/etc/ceph:/etc/ceph"

